import e,{useRef as t,useEffect as n,useState as r,useCallback as o}from"react";import a from"react-autosuggest";import l from"autosuggest-highlight/match";import s from"autosuggest-highlight/parse";import{Fade as i,LinearProgress as u,useTheme as c,Paper as p,alpha as g,Grid as m,IconButton as h,MenuItem as f,Typography as d,Box as b,InputBase as x,InputAdornment as y}from"@mui/material";import E from"@mui/icons-material/Search";import v from"@mui/icons-material/Cancel";import{useDebouncedCallback as w}from"use-debounce";function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function k(e){return null!=e}const S=({show:t=!1})=>{const[o,a]=r(t),l=w(()=>a(!0),250);return n(()=>{t?l():(l.flush(),a(!1))},[l,t]),e.createElement(i,{in:o},e.createElement(u,{style:{position:"absolute",width:"100%"}}))},j=["ref","inputClasses"],O=t=>{let n=C({},t);return e.createElement(x,C({type:"search",fullWidth:!0,startAdornment:e.createElement(y,{position:"start"},e.createElement(E,{color:"action"}))},n))};export default({endpoint:u="https://api.mapbox.com",inputPlaceholder:x="Search",showLoader:y=!0,source:E="mapbox.places",onSuggest:w=(()=>{}),focusOnMount:_=!1,showInputContainer:I=!0,inputValue:P="",proximity:$,country:R,bbox:T,types:q,limit:B,autocomplete:F,language:D,suggestionsPaperProps:G,onSelect:V,accessToken:W,onInputFocus:z,onInputBlur:H,inputClasses:L,inputProps:U,inputPaperProps:A})=>{const[M,N]=r([]),[J,K]=r(!1),[Q,X]=r(new Date),[Y,Z]=r(P),[ee,te]=r(!1),ne=t(null),re=function(e){const r=t();return n(()=>{r.current=e},[e]),r.current}(Y),oe=o(()=>{const{input:e=null}=ne.current||{};e&&e.focus()},[]);n(()=>{Z(P)},[P]),n(()=>{_&&oe()},[_,oe]),n(()=>{w&&w(M)},[M,w]);const ae=o(()=>{Z(""),oe()},[oe]),le=c(),se=o(t=>{const{ref:n,inputClasses:r}=t,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(o[n]=e[n]);return o}(t,j),a=C({},null!=A?A:{}),l=e.createElement(O,C({classes:r,inputRef:n},o,U));return I?e.createElement(e.Fragment,null,e.createElement(S,{show:J&&y}),e.createElement(p,C({square:!1,elevation:1,sx:{paddingTop:1,paddingBottom:1,paddingRight:1,paddingLeft:2,backgroundColor:ee?le.palette.background.paper:g(le.palette.background.paper,.9),overflow:"hidden","&:hover,&:active":{backgroundColor:le.palette.background.paper},minHeight:"64px",display:"flex",flexDirection:"column",justifyContent:"center"}},a),e.createElement(m,{container:!0,alignItems:"center",spacing:1,wrap:"nowrap"},e.createElement(m,{item:!0,xs:!0,sx:{flexShrink:0,flexGrow:1}},l),e.createElement(i,{in:Y.length>0,unmountOnExit:!0,mountOnEnter:!0},e.createElement(m,{item:!0,xs:!0,sx:{flexGrow:0,flexShrink:1}},e.createElement(h,{"aria-label":"Clear Search Input",onClick:ae,size:"large"},e.createElement(v,null))))))):l},[U,I,J,y,ee,A,Y.length,ae,le]),ie=o(e=>{te(!0),z&&z(e)},[z]),ue=o(e=>{te(!1),H&&H(e)},[H]),ce=o(t=>{const{containerProps:n,children:r}=t;return e.createElement(p,C({},n,{square:!1,elevation:4},G),r)},[G]),pe=o((e,t,n)=>{!e&&t&&t.features&&Q<=n&&(X(n),N(t.features.map(e=>({feature:e,label:e.place_name})).filter(e=>e.label)),K(!1))},[Q]),ge=o(({value:e})=>{K(!0),re===e?K(!1):""===e?(N([]),K(!1)):async function(e,t,n,r,o,a,l,s,i,u,c,p){const g=new Date;try{const h=`${e}/geocoding/v5/${t}/${r}.json`,f=C({},k(n)&&{access_token:n},k(a)&&{proximity:a&&2===Object.keys(a).length?`${a.longitude},${a.latitude}`:null},k(s)&&{bbox:s&&s.length>0?s.join(","):null},k(i)&&{types:i},k(l)&&{country:l},k(u)&&{limit:u},k(c)&&{autocomplete:c},k(p)&&{language:p}),d=`${h}?${m=f,Object.keys(m).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(m[e])).join("&")}`,b=await fetch(d);return o(null,await b.json(),g),{err:null,res:b,searchTime:g}}catch(e){return o(e,null,g),{err:e,res:null,searchTime:g}}var m}(u,E,W,e,pe,$,R,T,q,B,F,D)},[T,R,u,B,D,F,E,$,re,pe,q,W]),me=o((e,{suggestion:t})=>(V&&V(t.feature),!1),[V]),he=o(()=>{N([])},[]),fe=o((e,{newValue:t})=>{Z(t)},[]),de=o((t,{query:n,isHighlighted:r})=>{const o=l(t.label,n),a=s(t.label,o);return e.createElement(f,{selected:r,component:"div"},e.createElement(d,{noWrap:!0,variant:"subtitle1"},a.map((t,n)=>e.createElement(d,{key:n,component:"span",variant:"inherit",sx:{fontWeight:t.highlight?500:300}},t.text))))},[]),be=o(e=>e.label,[]);return W?e.createElement(b,{sx:{"& .react-autosuggest__container":{flexGrow:1,position:"relative"},"& .react-autosuggest__suggestions-container--open":{position:"absolute",zIndex:1,marginTop:1,left:0,right:0},"& .react-autosuggest__suggestions-list":{margin:0,padding:0,listStyleType:"none"},"& .react-autosuggest__suggestion":{display:"block",marginBottom:0}}},e.createElement(a,{ref:ne,renderInputComponent:se,suggestions:M,onSuggestionsFetchRequested:ge,onSuggestionsClearRequested:he,onSuggestionSelected:me,renderSuggestionsContainer:ce,getSuggestionValue:be,renderSuggestion:de,inputProps:{placeholder:x,value:Y,onChange:fe,onFocus:ie,onBlur:ue,className:L}})):null};
//# sourceMappingURL=index.modern.js.map
