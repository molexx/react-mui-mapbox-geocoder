import e,{useRef as t,useEffect as n,useState as r,useCallback as o}from"react";import a from"react-autosuggest";import l from"autosuggest-highlight/match";import s from"autosuggest-highlight/parse";import{Fade as i,LinearProgress as u,useTheme as c,Paper as p,alpha as g,Box as m,IconButton as f,MenuItem as h,Typography as d,InputBase as b,InputAdornment as x,TextField as E}from"@mui/material";import y from"@mui/icons-material/Search";import v from"@mui/icons-material/Cancel";import{useDebouncedCallback as C}from"use-debounce";function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function k(e){return null!=e}const S=({show:t=!1})=>{const[o,a]=r(t),l=C(()=>a(!0),250);return n(()=>{t?l():(l.flush(),a(!1))},[l,t]),/*#__PURE__*/e.createElement(i,{in:o},/*#__PURE__*/e.createElement(u,{style:{position:"absolute",width:"100%"}}))},j=["ref","inputClasses"],I=t=>{let n=w({},t);/*#__PURE__*/return e.createElement(b,w({type:"search",fullWidth:!0,startAdornment:/*#__PURE__*/e.createElement(x,{position:"start"},/*#__PURE__*/e.createElement(y,{color:"action"}))},n))},O=t=>{let n=w({},t);/*#__PURE__*/return e.createElement(E,w({type:"search",fullWidth:!0,InputProps:{startAdornment:/*#__PURE__*/e.createElement(x,{position:"start"},/*#__PURE__*/e.createElement(y,{color:"action"}))}},n))};export default({endpoint:u="https://api.mapbox.com",inputPlaceholder:b="Search",showLoader:x=!0,source:E="mapbox.places",onSuggest:y=(()=>{}),focusOnMount:C=!1,showInputContainer:P=!0,inputValue:_="",proximity:R,country:$,bbox:T,types:q,limit:F,autocomplete:B,language:D,suggestionsPaperProps:W,onSelect:G,accessToken:V,onInputFocus:z,onInputBlur:A,inputClasses:H,inputProps:L,textFieldProps:U,inputPaperProps:M,onInputClear:N})=>{const[J,K]=r([]),[Q,X]=r(!1),[Y,Z]=r(new Date),[ee,te]=r(_),[ne,re]=r(!1),oe=t(null),ae=function(e){const r=t();return n(()=>{r.current=e},[e]),r.current}(ee),le=o(()=>{const{input:e=null}=oe.current||{};e&&e.focus()},[]);n(()=>{te(_)},[_]),n(()=>{C&&le()},[C,le]),n(()=>{y&&y(J)},[J,y]),n(()=>{""===ee&&ee!==ae&&N&&N()},[ee,ae,N]);const se=o(()=>{te(""),le()},[le]),ie=c(),ue=o(t=>{const{ref:n,inputClasses:r}=t,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(o[n]=e[n]);return o}(t,j),a=w({},null!=M?M:{});let l=/*#__PURE__*/e.createElement(I,w({classes:r,inputRef:n},o,L));return U&&(l=/*#__PURE__*/e.createElement(O,w({classes:r,inputRef:n},o,U))),P?/*#__PURE__*/e.createElement(e.Fragment,null,/*#__PURE__*/e.createElement(S,{show:Q&&x}),/*#__PURE__*/e.createElement(p,w({square:!1,elevation:1,sx:{paddingTop:1,paddingBottom:1,paddingRight:1,paddingLeft:2,backgroundColor:ne?ie.palette.background.paper:g(ie.palette.background.paper,.9),overflow:"hidden","&:hover,&:active":{backgroundColor:ie.palette.background.paper},minHeight:"64px",display:"flex",flexDirection:"column",justifyContent:"center"}},a),/*#__PURE__*/e.createElement(m,{display:"flex",flexDirection:"row",alignItems:"center"},/*#__PURE__*/e.createElement(m,{flex:"auto",sx:{flexShrink:0,flexGrow:1}},l),/*#__PURE__*/e.createElement(i,{in:ee.length>0,unmountOnExit:!0,mountOnEnter:!0},/*#__PURE__*/e.createElement(m,{flex:"auto",sx:{flexGrow:0,flexShrink:1}},/*#__PURE__*/e.createElement(f,{"aria-label":"Clear Search Input",onClick:se,size:"large"},/*#__PURE__*/e.createElement(v,null))))))):l},[L,U,P,Q,x,ne,M,ee.length,se,ie]),ce=o(e=>{re(!0),z&&z(e)},[z]),pe=o(e=>{re(!1),A&&A(e)},[A]),ge=o(t=>{const{containerProps:n,children:r}=t;/*#__PURE__*/return e.createElement(p,w({},n,{square:!1,elevation:4},W),r)},[W]),me=o((e,t,n)=>{!e&&t&&t.features&&Y<=n&&(Z(n),K(t.features.map(e=>({feature:e,label:e.place_name})).filter(e=>e.label)),X(!1))},[Y]),fe=o(({value:e})=>{X(!0),ae===e?X(!1):""===e?(K([]),X(!1)):async function(e,t,n,r,o,a,l,s,i,u,c,p){const g=new Date;try{const f=`${e}/geocoding/v5/${t}/${r}.json`,h=w({},k(n)&&{access_token:n},k(a)&&{proximity:a&&2===Object.keys(a).length?`${a.longitude},${a.latitude}`:null},k(s)&&{bbox:s&&s.length>0?s.join(","):null},k(i)&&{types:i},k(l)&&{country:l},k(u)&&{limit:u},k(c)&&{autocomplete:c},k(p)&&{language:p}),d=`${f}?${m=h,Object.keys(m).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(m[e])).join("&")}`,b=await fetch(d);return o(null,await b.json(),g),{err:null,res:b,searchTime:g}}catch(e){return o(e,null,g),{err:e,res:null,searchTime:g}}var m}(u,E,V,e,me,R,$,T,q,F,B,D)},[T,$,u,F,D,B,E,R,ae,me,q,V]),he=o((e,{suggestion:t})=>(G&&G(t.feature),!1),[G]),de=o(()=>{K([])},[]),be=o((e,{newValue:t})=>{te(t)},[]),xe=o((t,{query:n,isHighlighted:r})=>{const o=l(t.label,n),a=s(t.label,o);/*#__PURE__*/return e.createElement(h,{selected:r,component:"div"},/*#__PURE__*/e.createElement(d,{noWrap:!0,variant:"subtitle1"},a.map((t,n)=>/*#__PURE__*/e.createElement(d,{key:n,component:"span",variant:"inherit",sx:{fontWeight:t.highlight?500:300}},t.text))))},[]),Ee=o(e=>e.label,[]);return V?/*#__PURE__*/e.createElement(m,{sx:{"& .react-autosuggest__container":{flexGrow:1,position:"relative"},"& .react-autosuggest__suggestions-container--open":{position:"absolute",zIndex:1,marginTop:1,left:0,right:0},"& .react-autosuggest__suggestions-list":{margin:0,padding:0,listStyleType:"none"},"& .react-autosuggest__suggestion":{display:"block",marginBottom:0}}},/*#__PURE__*/e.createElement(a,{ref:oe,renderInputComponent:ue,suggestions:J,onSuggestionsFetchRequested:fe,onSuggestionsClearRequested:de,onSuggestionSelected:he,renderSuggestionsContainer:ge,getSuggestionValue:Ee,renderSuggestion:xe,inputProps:{placeholder:b,value:ee,onChange:be,onFocus:ce,onBlur:pe,className:H}})):null};
//# sourceMappingURL=index.modern.mjs.map
